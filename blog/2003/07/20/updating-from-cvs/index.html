<!DOCTYPE HTML> 
<html>
   <head>
   <meta charset=utf-8> 
   <title>Updating from CVS &larr; </title>
   <meta name="author" content="Vinod Kurup" />

  <link rel="openid.server" href="http://www.myopenid.com/server" />
  <link rel="openid.delegate" href="http://vkurup.myopenid.com/" />
  <link rel="openid2.local_id" href="http://vkurup.myopenid.com" />
  <link rel="openid2.provider" href="http://www.myopenid.com/server" />
  <meta http-equiv="X-XRDS-Location" content="http://www.myopenid.com/xrds?username=vkurup.myopenid.com" />

	
	
	
  	<link rel="alternate" type="application/atom+xml" href="atom.xml" title="RSS feed" />
	

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/files/css/syntax.css" type="text/css" />

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/files/css/screen.css" type="text/css" />

</head>
<body id="">
<div id="site">

  <div id="header">
	<h1>
	<a href="/" title="My Personal Site">Vinod Kurup</a>
</h1>
<ul class="nav">
  <li><a class="home" href="/">Home</a></li>
  <li><a class="medicine" href="/medicine">Medicine</a></li>
  <li><a class="feed" href="/blog/atom.xml">Feed</a></li>
</ul>

  </div>

  <div id="page">
	
<h1 class="emphnext">Updating from CVS</h1>

<p>Here&#8217;s the steps I take in order to update my site from the latest OpenACS CVS. All of this info comes from <a href='http://piskorski.com/docs/cvs-conventions.html'>Andrew Piskorski&#8217;s great CVS page</a> or from pages listed in his document.</p>

<ol>
<li>
<p>Make sure that I&#8217;ve committed all the local changes that I&#8217;ve made.</p>

<p>vinod:~$ cd web/kurup vinod:~/web/kurup$ cvs commit -m &#8220;Fixed foo, bar and blah&#8221;</p>
</li>

<li>
<p>Go into the directory containing my OpenACS CVS checkout and grab the latest sources. I&#8217;m using the <code>oacs-4-6</code> branch.</p>

<p>vinod:~/web/kurup$ cd ~/web/openacs-4 vinod:~/web/openacs-4$ cvs update -r oacs-4-6</p>
</li>

<li>
<p>Import the code into a vendor branch. My repository name is <code>kurup</code>. <code>OpenACS</code> is the vendor tag.</p>

<p>vinod:~/web/openacs-4$ cvs -d /var/lib/cvs \ import -m &#8220;importing latest OpenACS 4.6 branch&#8221; \ kurup OpenACS openacs-4-6-3-20030719</p>
</li>

<li>
<p>This produces the usual CVS scroll and then a message like this:</p>

<p>7 conflicts created by this import. Use the following command to help the merge: cvs -d /var/lib/cvs checkout -j&#60;prev_rel_tag&#62; \ jopenacs-4-6-3-20030719 kurup</p>
</li>

<li>
<p>Follow the instructions just given above. This will checkout a full set of code into the <code>kurup</code> directory, while simultaneously merging the new imported code in.</p>

<p>vinod@vkurup:~/web/openacs-4$ cd vinod@vkurup:~$ mkdir tmp vinod@vkurup:~$ cd tmp vinod@vkurup:~/tmp$ cvs -d /var/lib/cvs checkout \ -jOpenACS:yesterday \ jopenacs-4-6-3-20030719 kurup</p>
</li>

<li>
<p>Go through and fix all the conflicts. This is the part that I sometimes find confusing. How to find the files that have conflicts? The command in instruction #3 above will list conflict files with a C in front of the filename. Check each file that has a C in front of it. This is why I like to do this process inside an emacs shell, so that I can look over the output as needed. For example, one piece of my listing looked like this:</p>

<p>U kurup/packages/lars-blogger/www/blog-oracle.xql U kurup/packages/lars-blogger/www/blog.adp C kurup/packages/lars-blogger/www/blog.tcl U kurup/packages/lars-blogger/www/calendar-oracle.xql</p>
</li>
</ol>

<p>So, I need to check ~/tmp/kurup/packages/lars-blogger/www/blog.tcl, look for conflict markers and resolve any conflicts. Do this for every file marked &#8216;C&#8217; in your listing.</p>

<ol>
<li>
<p>Commit my work.</p>

<p>vinod:~/tmp$ cd kurup vinod:~/tmp/kurup$ cvs commit \ -m &#8220;merged with openacs-4-6-3-20030719, conflicts resolved&#8221;</p>
</li>

<li>
<p>Blow away that tmp checkout</p>

<p>vinod:~/tmp/kurup$ cd vinod:~$ rm -r tmp</p>
</li>

<li>
<p>Update my local checkout</p>

<p>vinod:~$ cd web/kurup vinod:~/web/kurup$ cvs update</p>
</li>

<li>
<p>Restart my server.</p>

<p>vinod:~$ svc -t /service/master</p>
</li>

<li>
<p>Once the server is back up, I visit <code>http://kurup.org/acs-admin/apm</code> with my broswer and click on &#8216;Install Packages&#8217;. I look for any packages that are listed as &#8216;Upgrade&#8217;. Click on these packages and follow the instructions to perform any needed upgrades. This is always a touchy process because if the upgrade script errors out, your server may be left in an in-between state. Hope and pray liberally.</p>
</li>

<li>
<p>Repeat as needed, maybe monthly, or whenever there&#8217;s a new feature/bugfix available that you need.</p>
</li>
</ol>

<address class="signature">
  <span class="author">&nbsp;</span>
  <span class="date">20 July 2003</span>
  <span class="tags"><a href="http://www.google.com/search?q=openacs+site:www.kurup.org" rel="tag">openacs</a>  | <a href="http://www.google.com/search?q=cvs+site:www.kurup.org" rel="tag">cvs</a>  | <a href="http://www.google.com/search?q=updating+site:www.kurup.org" rel="tag">updating</a>  | <a href="http://www.google.com/search?q=programming+site:www.kurup.org" rel="tag">programming</a>  </span>
</address>

<!-- Discus Comments -->
<div id="disqus_thread"></div>

<!-- Enable Disqus comments -->
<script type="text/javascript">
    var disqus_developer = "0";
    var disqus_iframe_css = "http://www.kurup.org/blog/files/css/screen.css";
    var disqus_title = "Updating from CVS";
</script>
<script type="text/javascript" src="http://disqus.com/forums/vkurup/embed.js"></script>

<noscript>
		<a href="http://vkurup.disqus.com/?url=ref">View the discussion thread.</a>
</noscript>

<!-- DISQUS CODE -->
<script type="text/javascript">
//<![CDATA[
(function() {
	var links = document.getElementsByTagName('a');
	var query = '?';
	for(var i = 0; i < links.length; i++) {
	if(links[i].href.indexOf('#disqus_thread') >= 0) {
		query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
	}
	}
	document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/vkurup/get_num_replies.js' + query + '"></' + 'script>');
})();
//]]>
</script>

  </div>
  
  <div id="footer">
	<address>
		<span class="copyright">
			Design by 
			<a href="http://mark.reid.name">Mark Reid</a>, Content
			by <a href="mailto:vinod@kurup.com">Vinod Kurup</a>
			<br/>
			(<a rel="licence" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Some rights reserved</a>)			
		</span>
		<span class="engine">
			Powered by 
			<a href="http://github.com/mojombo/jekyll/" title="A static, minimalist CMS">Jekyll</a>
		</span>
	</address>
  </div>
</div>

<!-- Google Analytics -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker("UA-79447-1");
pageTracker._trackPageview();
} catch(err) {}
</script>
</body>
</html>
