
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>On Factoring Large Numbers - Vinod Kurup</title>
  <meta name="author" content="Vinod Kurup">

  
  <meta name="description" content="I wonder how many of my blog posts are based on stories from This
American Life. Probably not
enough. Every time I start to listen to a show, I&#8217 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://www.kurup.org/blog/2011/11/29/factoring-large-numbers">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/vkurup" rel="alternate" title="Vinod Kurup" type="application/atom+xml">
  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='//fonts.googleapis.com/css?family=Quattrocento' rel='stylesheet' type='text/css'>
<link href='//fonts.googleapis.com/css?family=Quattrocento+Sans' rel='stylesheet' type='text/css'>
<link href='//fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>

<meta name="verify-v1" content="7VLvj7jbZMA24/73SZ9uUEq3SeBuiX3+aSIBRtgH4jQ=" />
<link rel="openid.server" href="http://www.myopenid.com/server" />
<link rel="openid.delegate" href="http://vkurup.myopenid.com/" />
<link rel="openid2.local_id" href="http://vkurup.myopenid.com/" />
<link rel="openid2.provider" href="http://www.myopenid.com/server" />
<meta http-equiv="X-XRDS-Location" content="http://www.myopenid.com/xrds?username=vkurup.myopenid.com" />

<link href="/favicon.ico" rel="shortcut icon" />

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-79447-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Vinod Kurup</a></h1>
  
    <h2>Hospitalist/programmer in search of the meaning of life</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/vkurup" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.kurup.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul role=main-navigation>
  <li><a href="/">Blog</a></li>
  <li><a href="/about.html">About Me</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/blog/categories">Categories</a></li>
  <li><a href="/medicine">Medicine</a></li>
  <li><a href="/running">Running</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">On Factoring Large Numbers</h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-11-29T21:59:20-05:00" pubdate data-updated="true">Nov 29<span>th</span>, 2011</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>I wonder how many of my blog posts are based on stories from <a href="http://www.thisamericanlife.org">This
American Life</a>. Probably not
enough. Every time I start to listen to a show, I&#8217;m certain that I&#8217;m
not going to be interested and within a minute I&#8217;m trapped and can&#8217;t
stop listening. It&#8217;s that good. A <a href="http://www.thisamericanlife.org/radio-archives/episode/450/so-crazy-it-just-might-work">recent show was about people who
people who pursued crazy
ideas</a>.
The first story was about a mathematician named <a href="http://en.wikipedia.org/wiki/Frank_Nelson_Cole">Frank Nelson
Cole</a>. <a href="http://en.wikipedia.org/wiki/Mersenne_prime#History">Marin
Mersenne</a> had
claimed in the 17th century that 2<sup>67</sup>-1 was a prime
number. He was prominent enough that the claim was felt to be accepted
wisdom and there was certainly no way to test the claim in the days
before computers. That&#8217;s a big honking number:
147,573,952,589,676,412,927.</p>

<p>In 1903, Frank Nelson Cole walked into a meeting of mathematicians to
present his talk. The title was boring, something like &#8220;On the
factoring of large numbers&#8221;. Without speaking a word, he walked up to
the chalkboard and started to write a large number, followed by
another large number and then started to multiply them together. It
took a while, but by the time he started to get towards the solution,
the crowd of mathematicians understood that he was proving that he had
found two numbers whose product was the famous &#8220;prime&#8221; number
2<sup>67</sup>-1. As he came close to finishing, the anticipation
peaked and cheering began. He finished the calculation and sat down,
never speaking a word.</p>

<p>Stories like that give me the chills. Can you imagine how excited he
must have been when he found those 2 roots? I get that sensation every
once in a while when I make a programming breakthrough, solving a
problem which I had been banging my head on for a while. It&#8217;s nowhere as
profound as what he did, but I think I can understand the exhilaration
he must have felt.</p>

<p>I decided to see what those 2 roots are, using my new favorite
language, Clojure. I&#8217;m by no means an expert in anything, let alone
programming and especially functional programming, but here&#8217;s how I
went about it. The REPL is such a fun way to explore things like this:</p>

<ol>
<li><p>I need a range of numbers which I&#8217;ll then test one-by-one to see if
they divide into 2<sup>67</sup>-1 evenly.</p>

<pre><code> user=&gt; (def n 18)
 #'user/n
 user=&gt; (range 2 n)
 (2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17)
</code></pre></li>
<li><p>I need a way to take a square root.  (There&#8217;s no need to check
numbers higher than the square root of 2<sup>67</sup>-1)</p>

<pre><code> user=&gt; (Math/sqrt n)
 4.242640687119285
</code></pre></li>
<li><p>So the numbers I need to test are:</p>

<pre><code> user=&gt; (range 2 (inc (int (Math/sqrt n))))
 (2 3 4)
</code></pre></li>
<li><p>I need to find the remainder of a division (Of note, <code>mod</code> also does
the same thing, but <code>rem</code> is a lot faster)</p>

<pre><code> user=&gt; (rem 9 2)
 1
</code></pre></li>
<li><p>Can I find all the lower roots of a number? The <code>#(...)</code> syntax is
syntactic sugar for an anonymous function. The <code>%</code> is a placeholder
for the value which is being iterated over. So the following
function takes each value in the list returned by <code>range</code> and
supplies it to <code>rem</code>. If that <code>rem</code> function is equal to
zero, then the <code>#(...)</code> anonymous function returns true and <code>filter</code>
keeps the value.</p>

<pre><code> user=&gt; (def n 100)
 #'user/n
 user=&gt; (filter #(= (rem n %) 0) (range 2 (inc (int (Math/sqrt n)))))
 (2 4 5 10)
</code></pre></li>
<li><p>Now let&#8217;s map over each of those values, finding the corresponding
higher root for each value. <code>vector</code> creates a vector (think list)
with the first value being the supplied value and the second value
being the other root <code>(/ n %)</code>:</p>

<pre><code> user=&gt; (map #(vector % (/ n %)) (filter #(= (rem n %) 0) (range 2 (inc (int (Math/sqrt n))))))
 ([2 50] [4 25] [5 20] [10 10])
</code></pre></li>
<li><p>Based on that experimentation, here&#8217;s my first stab at the
function:</p>

<pre><code> user=&gt; (defn roots [n]
          (let [lower-factors (range 2 (inc (int (Math/sqrt n))))
                is-factor? (fn [a] (= (rem n a) 0))]
            (map  #(vector % (/ n %)) (filter is-factor? lower-factors))))
 #'user/roots
 user=&gt; (roots 294)
 ([2 147] [3 98] [6 49] [7 42] [14 21])
</code></pre></li>
<li><p>Now let&#8217;s get our big number (2<sup>67</sup>-1)</p>

<pre><code> user=&gt; (dec (Math/pow 2 67))
 1.4757395258967641E20
</code></pre></li>
<li><p>Hmmm&#8230; that looks like it might not be a precise value. Oh well,
let&#8217;s try it:</p>

<pre><code> user=&gt; (roots (dec (Math/pow 2 67)))
 ([2 7.378697629483821E19] [3 4.9191317529892135E19] [4
 3.6893488147419103E19] [5 2.9514790517935284E19] [6
 2.4595658764946067E19] [7 2.108199322709663E19] [8
 1.8446744073709552E19] [9 1.6397105843297378E19] [10
 1.4757395258967642E19] [11 1.3415813871788765E19] [12
 1.2297829382473034E19] [13 1.1351842506898186E19] [14
 1.0540996613548315E19] [15 9.838263505978427E18] [16
 9.223372036854776E18] [17 8.6808207405692006E18] [18
 8.1985529216486892E18] [19 7.7670501362987581E18] [20
 7.3786976294838211E18.....
 C-c C-c (ABORT, ABORT!!!)
</code></pre></li>
<li><p>OK, that didn&#8217;t work. It clearly found way too many roots, because
2<sup>67</sup>-1 was an approximation. We have to use BigIntegers which have
appropriate precision even with large numbers.</p>

<pre><code> user=&gt; (def two67minus1 (dec (.pow (BigInteger. "2") 67)))
 #'user/two67minus1
 user=&gt; two67minus1
 147573952589676412927
</code></pre></li>
<li><p>Cool, that looks more precise than our previous value. To see the
difference, check their type.</p>

<pre><code> user=&gt; (type (dec (Math/pow 2 67)))
 java.lang.Double
 user=&gt; (type (dec (.pow (BigInteger. "2") 67)))
 java.math.BigInteger
</code></pre></li>
<li><p>OK, Time for the big test:</p>

<pre><code> user=&gt; (roots two67minus1)
 ([193707721 761838257287])
</code></pre></li>
<li><p>Cool!!! It works! Those are the roots of 2<sup>67</sup>-1. How long did that
take to compute? (We need <code>doall</code> to make the <code>time</code> command wait
for all of the values to be calculated, otherwise it will return
after the first value is calculated. This has something to do with
the laziness of clojure sequences)</p>

<pre><code> user=&gt; (time (doall (roots two67minus1)))
 "Elapsed time: 2.2697318183297E7 msecs"
 ([193707721 761838257287])
</code></pre></li>
</ol>


<p>6 hours 18 minutes. I&#8217;m sure there&#8217;s a quicker way to do this. I do a
lot of redundant testing. For example, once we know that 2 is not a
factor, we shouldn&#8217;t check any more even factors. I&#8217;d be interested in
any advice to make it run faster.</p>

<p>I can&#8217;t even fathom how you&#8217;d go about doing this without a
computer. Can you imagine how frustrating it must&#8217;ve been any time you
had a simple error? Just amazing&#8230;</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Vinod Kurup</span></span>

      








  


<time datetime="2011-11-29T21:59:20-05:00" pubdate data-updated="true">Nov 29<span>th</span>, 2011</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/clojure/'>clojure</a>, <a class='category' href='/blog/categories/math/'>math</a>, <a class='category' href='/blog/categories/programming/'>programming</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="https://www.kurup.org/blog/2011/11/29/factoring-large-numbers" data-via="vkurup" data-counturl="https://www.kurup.org/blog/2011/11/29/factoring-large-numbers" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2011/11/12/clojurescript-and-phonegap" title="Previous Post: ClojureScript and PhoneGap">&laquo; ClojureScript and PhoneGap</a>
      
      
        <a class="basic-alignment right" href="/blog/2012/08/03/blogging-again" title="Next Post: Blogging Again">Blogging Again &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2018/12/20/triangle-race-series">Triangle Race Series</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/12/02/nest-journey">My Nest Journey</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/09/23/composting">Composting</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/09/22/starting-a-garden">Starting a garden</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/05/31/indian-civilization">History of Indian Civilization</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/05/30/autovacuum-fail">Autovacuum not running</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/05/29/renaissance-man">Renaissance Man</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/28/cbv-dynamic">Using dynamic queries in a CBV</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/23/some-emacs-posts">Some Emacs Posts</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/22/pygments-py3">Pygments on Arch Linux</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/21/django-test-models">How to create test models in Django</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/21/peanut-allergy-a-personal-clinical-review">Peanut Allergy, a personal clinical review</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/17/priorities-and-gtd">Priorities and GTD</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/16/gtd-again">GTD again?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/15/writing-paralysis">Writing paralysis</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/09/steal-my-web-app-idea">Steal My Web App Idea</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/12/30/how-to-change-the-rear-tire-on-a-12-inch-bicycle">How to change the rear tire on a 12 inch bicycle</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/11/05/nsbrief-gets-the-best-guests">NSBrief gets the best guests</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/10/24/emacs-for-python-programming">Emacs for Python Programming</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/10/15/emacs-autocomplete-stumbles-on-yasnippet">Emacs Autocomplete stumbles on yasnippet</a>
      </li>
    
  </ul>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("vkurup", 5, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/vkurup" class="twitter-follow-button" data-show-count="true">Follow @vkurup</a>
  
</section>


<section>
  <h1>My Pinboard</h1>
  <ul id="pinboard_linkroll">Fetching linkroll...</ul>
  <p><a href="http://pinboard.in/u:vkurup">My Pinboard Bookmarks &raquo;</a></p>
</section>
<script type="text/javascript">
  var linkroll = 'pinboard_linkroll'; //id target for pinboard list
  var pinboard_user = "vkurup"; //id target for pinboard list
  var pinboard_count = 10; //id target for pinboard list
  (function(){
    var pinboardInit = document.createElement('script');
    pinboardInit.type = 'text/javascript';
    pinboardInit.async = true;
    pinboardInit.src = '/javascripts/pinboard.js';
    document.getElementsByTagName('head')[0].appendChild(pinboardInit);
  })();
</script>




  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  <a rel="license"
  href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Some rights
  reserved</a> by <a rel="author" href="https://profiles.google.com/vvkurup/" title="View my Google Profile">Vinod Kurup</a> -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'vkurup';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'https://www.kurup.org/blog/2011/11/29/factoring-large-numbers';
        var disqus_url = 'https://www.kurup.org/blog/2011/11/29/factoring-large-numbers';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
